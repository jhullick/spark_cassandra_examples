{"paragraphs":[{"text":"//access Cassandra keyspark.table\r\nval keySpace = \"cloudcomputing\"\r\nval table = \"data\"\r\n\r\nval fullTable = sqlContext.read.format(\"org.apache.spark.sql.cassandra\").options(Map(\"keyspace\" -> keySpace, \"table\" -> table)).load()\r\ndf.createOrReplaceTempView(table)","user":"anonymous","dateUpdated":"2018-08-05T09:59:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"keySpace: String = cloudcomputing\ntable: String = data\nfullTable: org.apache.spark.sql.DataFrame = [campus: string, date: timestamp ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1532935447431_-1012564149","id":"20180730-072407_799047552","dateCreated":"2018-07-30T07:24:07+0000","dateStarted":"2018-08-05T09:59:56+0000","dateFinished":"2018-08-05T09:59:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:102"},{"text":"// retrieve records of one partition. \r\nval onePartition = fullTable.filter($\"campus\" === \"St Lucia\").select($\"date\", $\"sensor_id\", $\"temperature\") \r\n\r\nz.show(onePartition)","user":"anonymous","dateUpdated":"2018-08-05T09:59:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","sensor_id":"string","temperature":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"onePartition: org.apache.spark.sql.DataFrame = [date: timestamp, sensor_id: int ... 1 more field]\n"},{"type":"TABLE","data":"date\tsensor_id\ttemperature\n2018-06-01 00:00:00.0\t1\t26.1\n2018-06-01 00:00:00.0\t2\t26.5\n2018-06-01 00:00:00.0\t3\t25.0\n2018-06-02 00:00:00.0\t1\t28.5\n2018-06-02 00:00:00.0\t2\t29.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.97.168:4040/jobs/job?id=133"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1533023986108_1403435731","id":"20180731-075946_2118817073","dateCreated":"2018-07-31T07:59:46+0000","dateStarted":"2018-08-05T09:59:57+0000","dateFinished":"2018-08-05T09:59:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"text":"// use map reduce to calculate average temperature\r\n// step 1 map: one row -> one record\r\nval records = onePartition.as[(String,Int,Float)].map{\r\n    case (date, sensor_id, temperature) => (1, temperature)\r\n}\r\n\r\nval columnNames = Array(\"count\", \"temperate\")\r\n\r\nz.show(records.toDF(columnNames:_*))","user":"anonymous","dateUpdated":"2018-08-05T09:59:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"count":"string","temperate":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"records: org.apache.spark.sql.Dataset[(Int, Float)] = [_1: int, _2: float]\ncolumnNames: Array[String] = Array(count, temperate)\n"},{"type":"TABLE","data":"count\ttemperate\n1\t26.1\n1\t26.5\n1\t25.0\n1\t28.5\n1\t29.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.97.168:4040/jobs/job?id=134"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1532935592965_1585704852","id":"20180730-072632_942137842","dateCreated":"2018-07-30T07:26:32+0000","dateStarted":"2018-08-05T09:59:57+0000","dateFinished":"2018-08-05T09:59:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533459995391_1551936063","id":"20180805-090635_18398398","dateCreated":"2018-08-05T09:06:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2331","text":"// use map reduce to calculate average temperature\r\n// step 2 reduce: two records -> one (count, sum)\r\nval sum = records.reduce{\r\n    (a,b) => (a._1+b._1, a._2+b._2)\r\n}\r\n\r\nprintln(\"count=\"+sum._1+\", sum=\"+sum._2)\r\n","dateUpdated":"2018-08-05T09:59:58+0000","dateFinished":"2018-08-05T09:59:59+0000","dateStarted":"2018-08-05T09:59:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sum: (Int, Float) = (5,135.1)\ncount=5, sum=135.1\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.97.168:4040/jobs/job?id=135"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533462105351_1614325627","id":"20180805-094145_670942105","dateCreated":"2018-08-05T09:41:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7163","text":"// use map reduce to calculate average temperature\r\n// step 3, (count,sum) -> average\r\n\r\nval avg_temp = sum._2/sum._1","dateUpdated":"2018-08-05T09:59:59+0000","dateFinished":"2018-08-05T09:59:59+0000","dateStarted":"2018-08-05T09:59:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"avg_temp: Float = 27.02\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533462699883_-685546378","id":"20180805-095139_987994286","dateCreated":"2018-08-05T09:51:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9979","text":"// use map reduce to calculate average temperature\n// combine steps 1, 2, 3\nval sum = onePartition.as[(String,Int,Float)].map{\n    case (date, sensor_id, temperature) => (1, temperature)\n}.reduce{\n    (a,b) => (a._1+b._1, a._2+b._2)\n}\n\nval avg_temp = sum._2/sum._1","dateUpdated":"2018-08-05T09:59:59+0000","dateFinished":"2018-08-05T10:00:00+0000","dateStarted":"2018-08-05T09:59:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sum: (Int, Float) = (5,135.1)\navg_temp: Float = 27.02\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.97.168:4040/jobs/job?id=136"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1533462774946_-1916988070","id":"20180805-095254_462549132","dateCreated":"2018-08-05T09:52:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11318","dateUpdated":"2018-08-05T10:00:00+0000"}],"name":"use map reduce to calculate  average","id":"2DJSW6UQC","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}