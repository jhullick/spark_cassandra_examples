{"paragraphs":[{"text":"//access Cassandra keyspark.table\r\nval keySpace = \"cloudcomputing\"\r\nval table = \"data\"\r\n\r\nval df = sqlContext.read.format(\"org.apache.spark.sql.cassandra\").options(Map(\"keyspace\" -> keySpace, \"table\" -> table)).load()\r\ndf.createOrReplaceTempView(table)","user":"anonymous","dateUpdated":"2018-09-21T04:46:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"keySpace: String = cloudcomputing\ntable: String = data\ndf: org.apache.spark.sql.DataFrame = [campus: string, date: timestamp ... 2 more fields]\n"}]},"apps":[],"jobName":"paragraph_1537504871454_-2018720536","id":"20180730-072016_697336855","dateCreated":"2018-09-21T04:41:11+0000","dateStarted":"2018-09-21T04:46:53+0000","dateFinished":"2018-09-21T04:46:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:35245"},{"text":"%sql \n/* retrieve all records of a table. \nBE CAREFUL, it is a full table scan. \nIt is very slow when table is large */\nselect * from data","user":"anonymous","dateUpdated":"2018-09-21T04:46:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"campus":"string","date":"string","sensor_id":"string","temperature":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"campus\tdate\tsensor_id\ttemperature\nHerston\t2018-06-01 00:00:00.0\t6\t21.5\nSt Lucia\t2018-06-01 00:00:00.0\t1\t26.1\nSt Lucia\t2018-06-01 00:00:00.0\t2\t26.5\nSt Lucia\t2018-06-01 00:00:00.0\t3\t25.0\nSt Lucia\t2018-06-02 00:00:00.0\t1\t28.5\nSt Lucia\t2018-06-02 00:00:00.0\t2\t29.0\nGatton\t2018-06-01 00:00:00.0\t4\t23.5\nGatton\t2018-06-01 00:00:00.0\t5\t23.0\nGatton\t2018-06-02 00:00:00.0\t4\t22.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.99.122:4040/jobs/job?id=9","http://172.23.99.122:4040/jobs/job?id=10","http://172.23.99.122:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537504871455_793397751","id":"20180730-074651_1047615893","dateCreated":"2018-09-21T04:41:11+0000","dateStarted":"2018-09-21T04:46:54+0000","dateFinished":"2018-09-21T04:46:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:35246"},{"text":"%sql\n/* retrieve records of one partition. \nThis is the right way to use cassandra. \nThe computing time is independent from table size. */\nselect date, sensor_id, temperature\nfrom data\nwhere campus = 'St Lucia'\n","user":"anonymous","dateUpdated":"2018-09-21T04:46:56+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","sensor_id":"string","temperature":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"date\tsensor_id\ttemperature\n2018-06-01 00:00:00.0\t1\t26.1\n2018-06-01 00:00:00.0\t2\t26.5\n2018-06-01 00:00:00.0\t3\t25.0\n2018-06-02 00:00:00.0\t1\t28.5\n2018-06-02 00:00:00.0\t2\t29.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.99.122:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537504871455_-1901839241","id":"20180805-084310_2052887692","dateCreated":"2018-09-21T04:41:11+0000","dateStarted":"2018-09-21T04:46:56+0000","dateFinished":"2018-09-21T04:46:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:35247"},{"text":"%sql\r\n/* average of one partition */\r\nselect avg(temperature) as avg_temp\r\nfrom data\r\nwhere campus = 'St Lucia' \r\ngroup by campus","user":"anonymous","dateUpdated":"2018-09-21T04:46:56+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"avg_temp":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"avg_temp\n27.020000076293947\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.99.122:4040/jobs/job?id=13","http://172.23.99.122:4040/jobs/job?id=14","http://172.23.99.122:4040/jobs/job?id=15","http://172.23.99.122:4040/jobs/job?id=16","http://172.23.99.122:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537504871456_-688596806","id":"20180730-072208_1477771114","dateCreated":"2018-09-21T04:41:11+0000","dateStarted":"2018-09-21T04:46:56+0000","dateFinished":"2018-09-21T04:46:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:35248"},{"text":"%sql\n/* average of each group under one partition */\nselect date, avg(temperature) as avg_temp\nfrom data\nwhere campus = 'St Lucia'\ngroup by date\norder by date asc","user":"anonymous","dateUpdated":"2018-09-21T04:46:59+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"date":"string","avg_temp":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"date\tavg_temp\n2018-06-01 00:00:00.0\t25.866666793823242\n2018-06-02 00:00:00.0\t28.75\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.23.99.122:4040/jobs/job?id=18"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1537504871456_-708134743","id":"20180730-072225_332905506","dateCreated":"2018-09-21T04:41:11+0000","dateStarted":"2018-09-21T04:46:59+0000","dateFinished":"2018-09-21T04:47:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:35249"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2018-09-21T04:47:01+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1537504871456_266862769","id":"20180805-085242_509420269","dateCreated":"2018-09-21T04:41:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:35250"}],"name":"use Spark-SQL to manipulate Cassandra","id":"2DS7HWGPU","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}